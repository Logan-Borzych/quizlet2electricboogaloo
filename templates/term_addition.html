{% extends "base.html" %}
{% block title %}{{ set_id }}{% endblock %}
{% block content %}
<body style="background-color: #F4F4F4;">
    <div class="container">
        <h1>Create Your Terms</h1>
        <br />
        <!-- Container for dynamically adding term addition forms -->
        <div id="termFormsContainer">
            <!-- Initial term addition form -->
            <form class="termAdditionForm" id="termForm1">
                <input type="text" placeholder="Term" name="term">
                <input type="text" placeholder="Definition" name="definition">
            </form>
        </div>
        <br>
        <!-- Add more term button -->
        <button id="addTermButton" class="btn btn-secondary">Add Another Term</button>
        <button id="deleteLastButton" class="btn btn-danger">Delete Last Term</button>
        <br><br>
        <!-- Submit button for all term addition forms -->
        <button type="button" id="submitAllButton" class="btn btn-primary" style="background-color: #C0C0C0; border-color: #C0C0C0;">Submit All Terms</button>
    </div>

    <script>
        // Function to submit all term addition forms
        function submitAllForms() {
            var forms = document.querySelectorAll(".termAdditionForm");
            var formDataArray = [];
            
            forms.forEach(function(form) {
                var termInput = form.querySelector('input[name="term"]').value;
                var definitionInput = form.querySelector('input[name="definition"]').value;
                
                formDataArray.push({term: termInput, definition: definitionInput});
            });
            
            // Sending the form data array to the server
            fetch("{{ url_for('submit_terms', set_id=set_id) }}", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(formDataArray)
            }).then(function(response) {
                if (response.ok) {
                    console.log("Terms submitted successfully!");
                    // Optionally, you can redirect the user or display a success message here
                } else {
                    console.error("Failed to submit terms:", response.statusText);
                    // Optionally, display an error message to the user
                }
            }).catch(function(error) {
                console.error('Error:', error);
                // Handle network errors or other issues
            });
        }
    
        // Function to add new term addition form
        function addTermForm() {
            var container = document.getElementById("termFormsContainer");
            var newForm = document.createElement("form");
            newForm.classList.add("termAdditionForm");
            newForm.id = "termForm" + (container.children.length + 1);
            newForm.innerHTML = `
                <input type="text" placeholder="Term" name="term">
                <input type="text" placeholder="Definition" name="definition">
            `;
            container.appendChild(newForm);
        }
    
        // Event listener for "Add Another Term" button
        document.getElementById("addTermButton").addEventListener("click", function() {
            addTermForm();
        });

        // Function to remove the last term addition form
        function removeLastForm() {
            var container = document.getElementById("termFormsContainer");
            if (container.children.length > 1) {
                container.removeChild(container.lastElementChild);
            }
        }

        // Event listener for "Delete Last Term" button
        document.getElementById("deleteLastButton").addEventListener("click", function() {
            removeLastForm();
        });
    </script>
</body>
{% endblock %}
